# InfinityGrid: –£–º–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è:** `¬´Infinity¬ª` –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–º–∏ –Ω–∞–±–æ—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, `¬´Grid¬ª` ‚Äî —Ç–∞–±–ª–∏—á–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –∏ –≤—ã–±–æ—Ä–æ–º.

## –î–ª—è —á–µ–≥–æ –ø—Ä–æ–µ–∫—Ç?

**–ü—Ä–æ–µ–∫—Ç —Ä–µ—à–∞–µ—Ç 4 –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤:**

- üìâ `–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å` –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –º–∏–ª–ª–∏–æ–Ω–∞–º–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
- üß© `–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π` (–≤—ã–±–æ—Ä, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, —Ñ–∏–ª—å—Ç—Ä—ã).
- üîç `–ò–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏` –ø–æ –≥–∏–≥–∞–±–∞–π—Ç–∞–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
- üì± `–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å` ‚Äî –æ–¥–∏–Ω–∞–∫–æ–≤–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –∏ –º–æ—â–Ω—ã—Ö —Ä–∞–±–æ—á–∏—Ö —Å—Ç–∞–Ω—Ü–∏—è—Ö.

**–¶–µ–ª–µ–≤–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**

- - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –¥–ª—è `Big Data`
- - –°–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ–º (—Å–∫–ª–∞–¥—ã, –ª–æ–≥–∏—Å—Ç–∏–∫–∞)
- - –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- - `CRM` —Å –æ–≥—Ä–æ–º–Ω—ã–º–∏ –±–∞–∑–∞–º–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤

**–§–∏–ª–æ—Å–æ—Ñ–∏—è –ø—Ä–æ–µ–∫—Ç–∞:**

```textline
 -------------------------------------------------------------------
| ¬´–ú—ã –Ω–µ –≥—Ä—É–∑–∏–º –¥–∞–Ω–Ω—ã–µ ‚Äî –º—ã –∏—Ö –≤—ã–∑—ã–≤–∞–µ–º –∏–∑ —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø—É—Å—Ç–æ—Ç—ã,        |
| –ù–µ —Ö—Ä–∞–Ω–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Äî –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ–º –º–æ–º–µ–Ω—Ç –≤ –∫—Ä–∏—Å—Ç–∞–ª–ª–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, |
| –ù–µ –∏—â–µ–º ‚Äî –ø—Ä–µ–¥—É–≥–∞–¥—ã–≤–∞–µ–º,                                          |
| –ü–æ—Ç–æ–º—É —á—Ç–æ –≤ –º–∏—Ä–µ, –≥–¥–µ –∫–∞–∂–¥–∞—è –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞ —Å—Ç–æ–∏—Ç –¥–æ–ª–ª–∞—Ä–∞,         |
| InfinityGrid ‚Äî –≤–∞—à —Ö—Ä–æ–Ω–æ–º–µ—Ç—Ä –ø–æ–±–µ–¥—ã.¬ª                             |
 -------------------------------------------------------------------
```

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**

- Node.js v18+
- npm/yarn
- Git
- Docker (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è –¥–µ–ø–ª–æ—è)
- IDE (VS Code, WebStorm)

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–π
node -v && npm -v
```

### 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

```bash
mkdir infinilist && cd infinilist
mkdir server client

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞
cd server && npm init -y
npm install express cors compression lodash trie-search

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
cd ../client
npx create-react-app . --template typescript
npm install react-virtuoso @dnd-kit/core zustand react-query axios lodash.debounce
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (Express)

- - **–§–∞–π–ª:** `server/index.js`

```javascript
const express = require('express');
const cors = require('cors');
const Trie = require('trie-search');
const app = express();
app.use(express.json());
app.use(cors());

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 1M –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
const generateVirtualData = (size = 1e6) => 
  Array.from({length: size}, (_, i) => i + 1);

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä
const state = {
  data: generateVirtualData(),
  trie: new Trie('id'),
  order: new Map(),
  selected: new Set(),
  version: 0
};

// –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ Trie-–∏–Ω–¥–µ–∫—Å–∞
state.trie.addAll(state.data.map(id => ({id: id.toString()})));

// –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã
app.get('/items', (req, res) => {
  const {cursor = 0, search} = req.query;
  let result = state.data;
  
  // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
  if (search) {
    result = state.trie.get(search).map(x => parseInt(x.id));
  }
  
  // –ü–∞–≥–∏–Ω–∞—Ü–∏—è
  const start = parseInt(cursor);
  res.json({
    items: result.slice(start, start + 20),
    nextCursor: start + 20 < result.length ? start + 20 : null
  });
});

app.post('/state', (req, res) => {
  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –∏ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
  state.order = new Map(req.body.order);
  state.selected = new Set(req.body.selected);
  res.sendStatus(200);
});

app.listen(3001, () => 
  console.log('Server running on port 3001'));
```

### 4. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞ (React)

- - **–§–∞–π–ª:** `client/src/App.tsx`

```typescript
import {DndContext} from '@dnd-kit/core';
import {Virtuoso} from 'react-virtuoso';
import {useQueryClient, useInfiniteQuery} from 'react-query';
import axios from 'axios';

const API_URL = 'http://localhost:3001';

const fetchItems = async ({pageParam = 0, search = ''}) => {
  const res = await axios.get(`${API_URL}/items`, {
    params: {cursor: pageParam, search}
  });
  return res.data;
};

export default function List() {
  const [search, setSearch] = useState('');
  const {data, fetchNextPage} = useInfiniteQuery(
    ['items', search], 
    fetchItems,
    {getNextPageParam: (lastPage) => lastPage.nextCursor}
  );

  const handleSearch = useDebounce((value) => {
    setSearch(value);
    fetchNextPage({pageParam: 0});
  }, 300);

  return (
    <DndContext onDragEnd={handleDrag}>
      <input 
        type="text" 
        onChange={(e) => handleSearch(e.target.value)}
        placeholder="Search 1M items..."
      />
      
      <Virtuoso
        style={{height: '80vh'}}
        data={data?.pages.flatMap(p => p.items) || []}
        endReached={() => fetchNextPage()}
        itemContent={(index) => (
          <div className="item">
            <Checkbox />
            {data.pages.flatMap(p => p.items)[index]}
          </div>
        )}
      />
    </DndContext>
  );
}
```

### 5. –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ

**–í –¥–≤—É—Ö —Ç–µ—Ä–º–∏–Ω–∞–ª–∞—Ö:**

```bash
# –°–µ—Ä–≤–µ—Ä
cd server && node index.js

# –ö–ª–∏–µ–Ω—Ç
cd client && npm start
```

--

üíº **–ê–≤—Ç–æ—Ä:** –î—É–ø–ª–µ–π –ú–∞–∫—Å–∏–º –ò–≥–æ—Ä–µ–≤–∏—á

üì≤ **Telegram:** @quadd4rv1n7

üìÖ **–î–∞—Ç–∞:** 10.05.2025

‚ñ∂Ô∏è **–í–µ—Ä—Å–∏—è 1.0**

```textline
‚Äª –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤—É –º–æ–∂–µ—Ç–µ –ø—Ä–∏—Å—ã–ª–∞—Ç—å –Ω–∞ –ø–æ—á—Ç—É ‚Äª
üìß maksimqwe42@mail.ru
```
